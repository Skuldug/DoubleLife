[gd_scene load_steps=32 format=3 uid="uid://bhebgerashxk6"]

[ext_resource type="Texture2D" uid="uid://cayd7b4lkwb5w" path="res://test_sprites/HourglassFull.png" id="1_cgbea"]
[ext_resource type="Script" path="res://healthbar.gd" id="1_feowf"]
[ext_resource type="Shader" path="res://healthbar.gdshader" id="2_58oxb"]
[ext_resource type="Texture2D" uid="uid://b2pq8uc0v3t7c" path="res://test_sprites/HourglassEmpty.png" id="2_fegt5"]
[ext_resource type="Texture2D" uid="uid://bys0d4fuc3w68" path="res://test_sprites/HourglassMedium.png" id="3_xgy2y"]
[ext_resource type="Shader" path="res://blackout.gdshader" id="6_81ek6"]
[ext_resource type="Script" path="res://animation_player.gd" id="6_w84w3"]

[sub_resource type="AtlasTexture" id="AtlasTexture_r6blu"]
atlas = ExtResource("1_cgbea")
region = Rect2(0, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_jgxy0"]
atlas = ExtResource("1_cgbea")
region = Rect2(16, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_y2f1y"]
atlas = ExtResource("1_cgbea")
region = Rect2(0, 16, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_j2u3d"]
atlas = ExtResource("1_cgbea")
region = Rect2(16, 16, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_uv803"]
atlas = ExtResource("2_fegt5")
region = Rect2(0, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_y08uo"]
atlas = ExtResource("2_fegt5")
region = Rect2(16, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_slco5"]
atlas = ExtResource("2_fegt5")
region = Rect2(0, 16, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_sd3ip"]
atlas = ExtResource("2_fegt5")
region = Rect2(16, 16, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_d2li7"]
atlas = ExtResource("3_xgy2y")
region = Rect2(0, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_74ouc"]
atlas = ExtResource("3_xgy2y")
region = Rect2(16, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_wwd8f"]
atlas = ExtResource("3_xgy2y")
region = Rect2(0, 16, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_8ot2q"]
atlas = ExtResource("3_xgy2y")
region = Rect2(16, 16, 16, 16)

[sub_resource type="SpriteFrames" id="SpriteFrames_vkok5"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_r6blu")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_jgxy0")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_y2f1y")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_j2u3d")
}],
"loop": true,
"name": &"high",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_uv803")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_y08uo")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_slco5")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_sd3ip")
}],
"loop": true,
"name": &"low",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_d2li7")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_74ouc")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_wwd8f")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_8ot2q")
}],
"loop": true,
"name": &"medium",
"speed": 5.0
}]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_3bvac"]
shader = ExtResource("2_58oxb")
shader_parameter/transition_factor = 0.0

[sub_resource type="ViewportTexture" id="ViewportTexture_i8cnu"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_ekr0k"]
shader = ExtResource("6_81ek6")
shader_parameter/fade_factor = 0.0

[sub_resource type="CanvasTexture" id="CanvasTexture_d2fka"]

[sub_resource type="Animation" id="Animation_tynwk"]
length = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:material:shader_parameter/transition_factor")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.0]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("../Blackout:material:shader_parameter/fade_factor")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.0]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("%Blackout:material:shader_parameter/fade_factor")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.0]
}

[sub_resource type="Animation" id="Animation_0nxo0"]
resource_name = "greyscale"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:material:shader_parameter/transition_factor")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [0.0, 1.0]
}

[sub_resource type="Animation" id="Animation_gvnkq"]
resource_name = "death"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("../Blackout:material:shader_parameter/fade_factor")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.466667, 0.8, 1),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 0,
"values": [0.0, 1.0, 1.0, 0.0]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath(".:material:shader_parameter/transition_factor")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.5, 1),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [0.0, 1.0, 1.0]
}

[sub_resource type="Animation" id="Animation_dtmg3"]
resource_name = "ungreyscale"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:material:shader_parameter/transition_factor")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [1.0, 0.0]
}

[sub_resource type="Animation" id="Animation_3y5nn"]
resource_name = "blackout_ghost"
length = 1.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("%Blackout:material:shader_parameter/fade_factor")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.266667, 1.1, 1.5),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 0,
"values": [0.0, 1.0, 1.0, 0.0]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath(".:material:shader_parameter/transition_factor")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 1.5),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [1.0, 0.0]
}

[sub_resource type="Animation" id="Animation_v4gh8"]
resource_name = "blackout"
length = 1.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("%Blackout:material:shader_parameter/fade_factor")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5, 1, 1.5),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 0,
"values": [0.0, 1.0, 1.0, 0.0]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_otf3n"]
_data = {
"RESET": SubResource("Animation_tynwk"),
"blackout": SubResource("Animation_v4gh8"),
"blackout_ghost": SubResource("Animation_3y5nn"),
"death": SubResource("Animation_gvnkq"),
"greyscale": SubResource("Animation_0nxo0"),
"ungreyscale": SubResource("Animation_dtmg3")
}

[node name="Healthbar" type="CanvasLayer"]
process_mode = 3
auto_translate_mode = 1
follow_viewport_enabled = true
script = ExtResource("1_feowf")

[node name="Control" type="Control" parent="."]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="MarginContainer" type="MarginContainer" parent="Control"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/margin_left = 32
theme_override_constants/margin_top = 32
theme_override_constants/margin_right = 32
theme_override_constants/margin_bottom = 32

[node name="HBoxContainer" type="HBoxContainer" parent="Control/MarginContainer"]
layout_mode = 2

[node name="health_display" type="AnimatedSprite2D" parent="Control/MarginContainer/HBoxContainer"]
unique_name_in_owner = true
texture_filter = 1
scale = Vector2(6.3125, 6.3125)
sprite_frames = SubResource("SpriteFrames_vkok5")
animation = &"medium"
offset = Vector2(8, 8)

[node name="Greyscale" type="TextureRect" parent="."]
unique_name_in_owner = true
process_mode = 3
show_behind_parent = true
top_level = true
clip_children = 2
material = SubResource("ShaderMaterial_3bvac")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
texture = SubResource("ViewportTexture_i8cnu")

[node name="Blackout" type="TextureRect" parent="."]
unique_name_in_owner = true
material = SubResource("ShaderMaterial_ekr0k")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
texture = SubResource("CanvasTexture_d2fka")

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
process_mode = 3
root_node = NodePath("../Greyscale")
libraries = {
"": SubResource("AnimationLibrary_otf3n")
}
script = ExtResource("6_w84w3")
